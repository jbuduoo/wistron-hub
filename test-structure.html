<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°ˆæ¡ˆçµæ§‹æ¸¬è©¦</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #3b82f6;
            padding-bottom: 10px;
        }
        h2 {
            color: #555;
            margin-top: 0;
        }
        .test-item {
            padding: 10px;
            margin: 5px 0;
            border-radius: 4px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .test-item.pass {
            background: #d4edda;
            color: #155724;
        }
        .test-item.fail {
            background: #f8d7da;
            color: #721c24;
        }
        .test-item.warning {
            background: #fff3cd;
            color: #856404;
        }
        .status {
            font-weight: bold;
        }
        .summary {
            background: #e7f3ff;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
        }
        .summary h3 {
            margin-top: 0;
            color: #004085;
        }
        button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 10px;
        }
        button:hover {
            background: #2563eb;
        }
        pre {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <h1>ğŸ§ª å°ˆæ¡ˆçµæ§‹æ¸¬è©¦å·¥å…·</h1>
    
    <div class="test-container">
        <h2>1. æ–‡ä»¶çµæ§‹æ¸¬è©¦</h2>
        <div id="fileStructureTest"></div>
    </div>
    
    <div class="test-container">
        <h2>2. HTML è·¯å¾‘å¼•ç”¨æ¸¬è©¦</h2>
        <div id="pathReferenceTest"></div>
    </div>
    
    <div class="test-container">
        <h2>3. JavaScript æ–‡ä»¶è¼‰å…¥æ¸¬è©¦</h2>
        <div id="jsLoadTest"></div>
    </div>
    
    <div class="test-container">
        <h2>4. CSS æ–‡ä»¶è¼‰å…¥æ¸¬è©¦</h2>
        <div id="cssLoadTest"></div>
    </div>
    
    <div class="test-container">
        <h2>5. èªæ³•æª¢æŸ¥</h2>
        <div id="syntaxTest"></div>
    </div>
    
    <div class="summary" id="summary"></div>
    
    <button onclick="runAllTests()">ğŸ”„ é‡æ–°åŸ·è¡Œæ‰€æœ‰æ¸¬è©¦</button>
    
    <script>
        const tests = {
            fileStructure: [],
            pathReferences: [],
            jsLoad: [],
            cssLoad: [],
            syntax: []
        };
        
        // æ¸¬è©¦æ–‡ä»¶çµæ§‹
        async function testFileStructure() {
            const requiredFiles = {
                'js/auth.js': 'èªè­‰æ¨¡çµ„',
                'js/script.js': 'ä¸»è¦è…³æœ¬',
                'js/supabase-api.js': 'Supabase API',
                'js/supabase-config.js': 'Supabase è¨­å®š',
                'js/github-api.js': 'GitHub API',
                'css/styles.css': 'æ¨£å¼è¡¨'
            };
            
            const htmlFiles = ['index.html', 'upload.html', 'detail.html', 'login.html', 'register.html', 'test-supabase.html'];
            
            tests.fileStructure = [];
            
            // æª¢æŸ¥ JS å’Œ CSS æ–‡ä»¶
            for (const [file, description] of Object.entries(requiredFiles)) {
                try {
                    const response = await fetch(file, { method: 'HEAD' });
                    if (response.ok) {
                        tests.fileStructure.push({ 
                            name: file, 
                            status: 'pass', 
                            message: `âœ… ${description} å­˜åœ¨` 
                        });
                    } else {
                        tests.fileStructure.push({ 
                            name: file, 
                            status: 'fail', 
                            message: `âŒ ${description} ä¸å­˜åœ¨ (${response.status})` 
                        });
                    }
                } catch (error) {
                    tests.fileStructure.push({ 
                        name: file, 
                        status: 'fail', 
                        message: `âŒ ${description} ç„¡æ³•è¨ªå•: ${error.message}` 
                    });
                }
            }
            
            // æª¢æŸ¥ HTML æ–‡ä»¶
            for (const htmlFile of htmlFiles) {
                try {
                    const response = await fetch(htmlFile, { method: 'HEAD' });
                    if (response.ok) {
                        tests.fileStructure.push({ 
                            name: htmlFile, 
                            status: 'pass', 
                            message: `âœ… ${htmlFile} å­˜åœ¨` 
                        });
                    } else {
                        tests.fileStructure.push({ 
                            name: htmlFile, 
                            status: 'fail', 
                            message: `âŒ ${htmlFile} ä¸å­˜åœ¨` 
                        });
                    }
                } catch (error) {
                    tests.fileStructure.push({ 
                        name: htmlFile, 
                        status: 'fail', 
                        message: `âŒ ${htmlFile} ç„¡æ³•è¨ªå•` 
                    });
                }
            }
            
            displayResults('fileStructureTest', tests.fileStructure);
        }
        
        // æ¸¬è©¦ HTML è·¯å¾‘å¼•ç”¨
        async function testPathReferences() {
            const htmlFiles = ['index.html', 'upload.html', 'detail.html', 'login.html', 'register.html', 'test-supabase.html'];
            tests.pathReferences = [];
            
            for (const htmlFile of htmlFiles) {
                try {
                    const response = await fetch(htmlFile);
                    const html = await response.text();
                    
                    // æª¢æŸ¥ CSS è·¯å¾‘
                    const cssMatches = html.match(/href=["']([^"']*\.css[^"']*)["']/g) || [];
                    const cssPaths = cssMatches.map(m => m.match(/href=["']([^"']+)["']/)[1]);
                    
                    // æª¢æŸ¥ JS è·¯å¾‘
                    const jsMatches = html.match(/src=["']([^"']*\.js[^"']*)["']/g) || [];
                    const jsPaths = jsMatches.map(m => m.match(/src=["']([^"']+)["']/)[1]).filter(p => !p.includes('cdn.jsdelivr.net'));
                    
                    let hasError = false;
                    let errors = [];
                    
                    // æª¢æŸ¥ CSS è·¯å¾‘
                    for (const cssPath of cssPaths) {
                        if (!cssPath.startsWith('css/') && cssPath !== 'favicon.svg') {
                            hasError = true;
                            errors.push(`CSS è·¯å¾‘éŒ¯èª¤: ${cssPath} (æ‡‰è©²ä»¥ css/ é–‹é ­)`);
                        }
                    }
                    
                    // æª¢æŸ¥ JS è·¯å¾‘
                    for (const jsPath of jsPaths) {
                        if (!jsPath.startsWith('js/') && !jsPath.startsWith('http')) {
                            hasError = true;
                            errors.push(`JS è·¯å¾‘éŒ¯èª¤: ${jsPath} (æ‡‰è©²ä»¥ js/ é–‹é ­)`);
                        }
                    }
                    
                    if (hasError) {
                        tests.pathReferences.push({
                            name: htmlFile,
                            status: 'fail',
                            message: `âŒ è·¯å¾‘å¼•ç”¨éŒ¯èª¤:\n${errors.join('\n')}`
                        });
                    } else {
                        tests.pathReferences.push({
                            name: htmlFile,
                            status: 'pass',
                            message: `âœ… æ‰€æœ‰è·¯å¾‘å¼•ç”¨æ­£ç¢º\nCSS: ${cssPaths.length} å€‹\nJS: ${jsPaths.length} å€‹`
                        });
                    }
                } catch (error) {
                    tests.pathReferences.push({
                        name: htmlFile,
                        status: 'fail',
                        message: `âŒ ç„¡æ³•è®€å–æ–‡ä»¶: ${error.message}`
                    });
                }
            }
            
            displayResults('pathReferenceTest', tests.pathReferences);
        }
        
        // æ¸¬è©¦ JavaScript æ–‡ä»¶è¼‰å…¥
        async function testJSLoad() {
            const jsFiles = [
                'js/supabase-config.js',
                'js/supabase-api.js',
                'js/script.js',
                'js/auth.js'
            ];
            
            tests.jsLoad = [];
            
            for (const jsFile of jsFiles) {
                try {
                    const response = await fetch(jsFile);
                    if (response.ok) {
                        const content = await response.text();
                        
                        // ç°¡å–®çš„èªæ³•æª¢æŸ¥
                        let syntaxErrors = [];
                        
                        // æª¢æŸ¥æ˜¯å¦æœ‰æœªé–‰åˆçš„æ‹¬è™Ÿ
                        const openBraces = (content.match(/{/g) || []).length;
                        const closeBraces = (content.match(/}/g) || []).length;
                        if (openBraces !== closeBraces) {
                            syntaxErrors.push(`å¤§æ‹¬è™Ÿä¸åŒ¹é… (é–‹: ${openBraces}, é–‰: ${closeBraces})`);
                        }
                        
                        const openParens = (content.match(/\(/g) || []).length;
                        const closeParens = (content.match(/\)/g) || []).length;
                        if (openParens !== closeParens) {
                            syntaxErrors.push(`å°æ‹¬è™Ÿä¸åŒ¹é… (é–‹: ${openParens}, é–‰: ${closeParens})`);
                        }
                        
                        if (syntaxErrors.length > 0) {
                            tests.jsLoad.push({
                                name: jsFile,
                                status: 'warning',
                                message: `âš ï¸ è¼‰å…¥æˆåŠŸï¼Œä½†æœ‰èªæ³•å•é¡Œ:\n${syntaxErrors.join('\n')}`
                            });
                        } else {
                            tests.jsLoad.push({
                                name: jsFile,
                                status: 'pass',
                                message: `âœ… è¼‰å…¥æˆåŠŸ (${Math.round(content.length / 1024)} KB)`
                            });
                        }
                    } else {
                        tests.jsLoad.push({
                            name: jsFile,
                            status: 'fail',
                            message: `âŒ ç„¡æ³•è¼‰å…¥ (${response.status})`
                        });
                    }
                } catch (error) {
                    tests.jsLoad.push({
                        name: jsFile,
                        status: 'fail',
                        message: `âŒ è¼‰å…¥å¤±æ•—: ${error.message}`
                    });
                }
            }
            
            displayResults('jsLoadTest', tests.jsLoad);
        }
        
        // æ¸¬è©¦ CSS æ–‡ä»¶è¼‰å…¥
        async function testCSSLoad() {
            tests.cssLoad = [];
            
            try {
                const response = await fetch('css/styles.css');
                if (response.ok) {
                    const content = await response.text();
                    
                    // æª¢æŸ¥ CSS èªæ³•
                    let syntaxErrors = [];
                    
                    // æª¢æŸ¥æ˜¯å¦æœ‰æœªé–‰åˆçš„å¤§æ‹¬è™Ÿ
                    const openBraces = (content.match(/{/g) || []).length;
                    const closeBraces = (content.match(/}/g) || []).length;
                    if (openBraces !== closeBraces) {
                        syntaxErrors.push(`å¤§æ‹¬è™Ÿä¸åŒ¹é… (é–‹: ${openBraces}, é–‰: ${closeBraces})`);
                    }
                    
                    if (syntaxErrors.length > 0) {
                        tests.cssLoad.push({
                            name: 'css/styles.css',
                            status: 'warning',
                            message: `âš ï¸ è¼‰å…¥æˆåŠŸï¼Œä½†æœ‰èªæ³•å•é¡Œ:\n${syntaxErrors.join('\n')}`
                        });
                    } else {
                        tests.cssLoad.push({
                            name: 'css/styles.css',
                            status: 'pass',
                            message: `âœ… è¼‰å…¥æˆåŠŸ (${Math.round(content.length / 1024)} KB)`
                        });
                    }
                } else {
                    tests.cssLoad.push({
                        name: 'css/styles.css',
                        status: 'fail',
                        message: `âŒ ç„¡æ³•è¼‰å…¥ (${response.status})`
                    });
                }
            } catch (error) {
                tests.cssLoad.push({
                    name: 'css/styles.css',
                    status: 'fail',
                    message: `âŒ è¼‰å…¥å¤±æ•—: ${error.message}`
                });
            }
            
            displayResults('cssLoadTest', tests.cssLoad);
        }
        
        // é¡¯ç¤ºçµæœ
        function displayResults(containerId, results) {
            const container = document.getElementById(containerId);
            container.innerHTML = results.map(result => `
                <div class="test-item ${result.status}">
                    <div>
                        <strong>${result.name}</strong>
                        <pre style="margin: 5px 0 0 0; background: transparent; padding: 0;">${result.message}</pre>
                    </div>
                    <span class="status">${result.status === 'pass' ? 'âœ…' : result.status === 'fail' ? 'âŒ' : 'âš ï¸'}</span>
                </div>
            `).join('');
        }
        
        // é¡¯ç¤ºç¸½çµ
        function displaySummary() {
            const allTests = [
                ...tests.fileStructure,
                ...tests.pathReferences,
                ...tests.jsLoad,
                ...tests.cssLoad
            ];
            
            const passed = allTests.filter(t => t.status === 'pass').length;
            const failed = allTests.filter(t => t.status === 'fail').length;
            const warnings = allTests.filter(t => t.status === 'warning').length;
            const total = allTests.length;
            
            const summary = document.getElementById('summary');
            summary.innerHTML = `
                <h3>ğŸ“Š æ¸¬è©¦ç¸½çµ</h3>
                <p><strong>ç¸½æ¸¬è©¦æ•¸:</strong> ${total}</p>
                <p style="color: #155724;"><strong>âœ… é€šé:</strong> ${passed}</p>
                <p style="color: #721c24;"><strong>âŒ å¤±æ•—:</strong> ${failed}</p>
                <p style="color: #856404;"><strong>âš ï¸ è­¦å‘Š:</strong> ${warnings}</p>
                <p><strong>æˆåŠŸç‡:</strong> ${total > 0 ? Math.round((passed / total) * 100) : 0}%</p>
                ${failed === 0 ? '<p style="color: #155724; font-weight: bold;">ğŸ‰ æ‰€æœ‰æ¸¬è©¦é€šéï¼å¯ä»¥å®‰å…¨åœ°æäº¤åˆ° Gitã€‚</p>' : '<p style="color: #721c24; font-weight: bold;">âš ï¸ æœ‰æ¸¬è©¦å¤±æ•—ï¼Œè«‹å…ˆä¿®å¾©å•é¡Œå†æäº¤ã€‚</p>'}
            `;
        }
        
        // åŸ·è¡Œæ‰€æœ‰æ¸¬è©¦
        async function runAllTests() {
            document.getElementById('summary').innerHTML = '<p>æ¸¬è©¦ä¸­...</p>';
            
            await testFileStructure();
            await testPathReferences();
            await testJSLoad();
            await testCSSLoad();
            
            displaySummary();
        }
        
        // é é¢è¼‰å…¥æ™‚è‡ªå‹•åŸ·è¡Œæ¸¬è©¦
        window.addEventListener('DOMContentLoaded', runAllTests);
    </script>
</body>
</html>


